
-- ==================================================
-- ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∂‡∏á‡πÅ‡∏Ñ‡∏£‡∏Å‡∏Å‡∏π‡πÅ‡∏ï‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡∏≤‡∏Å‡πÜ‡∏ô‡∏±‡πâ‡∏á‡∏≠‡πâ‡∏ß‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏´‡πâ‡∏≠üòÇ
-- Congratulations on cracking my code, you idiot. You wasted my time on crappy code.üòÇ
-- ================‚â†===================================




local WindUI = loadstring(game:HttpGet(
    "https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"
))()

local PURPLE = Color3.fromHex("#8E54E9")
local PINK   = Color3.fromHex("#FF5FD2")
local BLUE   = Color3.fromHex("#4776E6")
local WHITE  = Color3.fromHex("#FFFFFF")

local DARK_BG1 = Color3.fromHex("#0D0B1E")
local DARK_BG2 = Color3.fromHex("#140F2E")
local MAIN_GRADIENT = WindUI:Gradient({
    ["0"]   = { Color = PURPLE, Transparency = 0 },
    ["50"]  = { Color = PINK,   Transparency = 0 },
    ["100"] = { Color = BLUE,   Transparency = 0 },
}, { Rotation = 45 })

local BACKGROUND_GRADIENT = WindUI:Gradient({
    ["0"]   = { Color = PURPLE, Transparency = 0.35 },
    ["50"]  = { Color = PINK,   Transparency = 0.35 },
    ["100"] = { Color = BLUE,   Transparency = 0.35 },
}, { Rotation = 45 })

local DARK_TAB_GRADIENT = WindUI:Gradient({
    ["0"]   = { Color = DARK_BG1, Transparency = 0 },
    ["100"] = { Color = DARK_BG2, Transparency = 0 },
}, { Rotation = 90 })


WindUI:AddTheme({
    Name = "ERROR HUBTheme",

    Accent = MAIN_GRADIENT,
    Hover  = MAIN_GRADIENT,

    Background = BACKGROUND_GRADIENT,
    BackgroundTransparency = 0.35,

    Outline = BLUE,
    Text = WHITE,
    Placeholder = Color3.fromHex("#E6DFFF"),
    Icon = WHITE,

    WindowBackground = BACKGROUND_GRADIENT,
    WindowShadow = Color3.fromRGB(0,0,0),

    -- TOPBAR
    WindowTopbarButtonIcon = WHITE,
    WindowTopbarTitle = WHITE,
    WindowTopbarAuthor = WHITE,
    WindowTopbarIcon = WHITE,

  
    TabBackground = DARK_TAB_GRADIENT,
    TabTitle = WHITE,
    TabIcon = WHITE,

    ElementBackground = DARK_TAB_GRADIENT,
    ElementTitle = WHITE,
    ElementDesc = Color3.fromHex("#E0D8FF"),
    ElementIcon = Color3.fromHex("#E0D8FF"),
    Button = MAIN_GRADIENT,
    Toggle = MAIN_GRADIENT,
    ToggleBar = WHITE,
    Checkbox = MAIN_GRADIENT,
    CheckboxIcon = WHITE,
    Slider = MAIN_GRADIENT,
    SliderThumb = WHITE,
    PopupBackground = BACKGROUND_GRADIENT,
    PopupBackgroundTransparency = 0.2,
    PopupTitle = WHITE,
    PopupContent = WHITE,
    PopupIcon = WHITE,

    DialogBackground = BACKGROUND_GRADIENT,
    DialogBackgroundTransparency = 0.2,
    DialogTitle = WHITE,
    DialogContent = WHITE,
    DialogIcon = WHITE,
})

WindUI:SetTheme("PurplePinkBlue")

local Window = WindUI:CreateWindow({
    Title = "ERROR HUB | Prison Life | Free",
    Icon = "rbxassetid://108455308252343", 
    Author = "Seesa",
    Folder = "ERROR HUB [ ALL Map ]",
    Size = UDim2.fromOffset(450, 330),
    Theme = "ERROR HUBTheme", 
    Transparent = true,
    Resizable = true,
})


local Players = game:GetService("Players")
local Teams = game:GetService("Teams")
local LP = Players.LocalPlayer
local Cam = workspace.CurrentCamera
local RS = game:GetService("RunService")


-- CONFIG
getgenv().SilentAimbot = false
getgenv().SAIM_FOV = 120
getgenv().SAIM_TEAM_LIST = {
    Neutral = true,
    Guards = false,
    Inmates = false,
    Criminals = false
}
local buffEnabled = false
local ESP_Name = false
local ESP_Health = false
local ESP_Distance = false
local ESP_Highlight = false
local TEXT_SIZE = 12

local Body = {
    WalkSpeed = {
        Enabled = false,
        Value = 16,
        Default = 16
    }
}






-- DRAW FOV CIRCLE 
local FOVCircle = Drawing.new("Circle")
FOVCircle.Thickness = 2
FOVCircle.Filled = false
FOVCircle.Color = Color3.fromRGB(255, 255, 255)
FOVCircle.Radius = getgenv().SAIM_FOV
FOVCircle.Visible = false

-- DRAW AIM LINE 
local AimLine = Drawing.new("Line")
AimLine.Thickness = 1.5
AimLine.Color = Color3.fromRGB(255, 0, 0)
AimLine.Visible = false

local function updateTeamsFromDropdown(selectedTeams)
    for teamName, _ in pairs(getgenv().SAIM_TEAM_LIST) do
        getgenv().SAIM_TEAM_LIST[teamName] = false
    end
    
    if type(selectedTeams) == "table" then
        for _, teamName in ipairs(selectedTeams) do
            if getgenv().SAIM_TEAM_LIST[teamName] ~= nil then
                getgenv().SAIM_TEAM_LIST[teamName] = true
            end
        end
    end
end

-- TEAM CHECK
local function isAllowedTeam(plr)
    if plr == LP then return false end
    
    for teamName, enabled in pairs(getgenv().SAIM_TEAM_LIST) do
        if enabled then
            local teamObj = Teams:FindFirstChild(teamName)
            if teamObj and plr.Team == teamObj then
                return true
            end
        end
    end
    
    if getgenv().SAIM_TEAM_LIST["Neutral"] and (not plr.Team or plr.Team.Name == "Neutral") then
        return true
    end
    
    return false
end

-- GET TARGET
local function getTarget()
    if not getgenv().SilentAimbot then return end
    
    local best, dist = nil, math.huge
    local cx, cy = Cam.ViewportSize.X/2, Cam.ViewportSize.Y/2
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LP and isAllowedTeam(player) and player.Character then
            local head = player.Character:FindFirstChild("Head")
            if head then
                local pos, vis = Cam:WorldToViewportPoint(head.Position)
                if vis then
                    local distance = math.sqrt((pos.X - cx)^2 + (pos.Y - cy)^2)
                    if distance <= getgenv().SAIM_FOV and distance < dist then
                        best = head
                        dist = distance
                    end
                end
            end
        end
    end
    
    return best
end

-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Visuals
RS.RenderStepped:Connect(function()
    FOVCircle.Position = Vector2.new(Cam.ViewportSize.X/2, Cam.ViewportSize.Y/2)
    FOVCircle.Radius = getgenv().SAIM_FOV
    FOVCircle.Visible = getgenv().SilentAimbot
    
    if getgenv().SilentAimbot then
        local targetHead = getTarget()
        if targetHead then
            local screenPos, onScreen = Cam:WorldToViewportPoint(targetHead.Position)
            if onScreen then
                AimLine.From = Vector2.new(Cam.ViewportSize.X/2, Cam.ViewportSize.Y/2)
                AimLine.To = Vector2.new(screenPos.X, screenPos.Y)
                AimLine.Visible = true
            else
                AimLine.Visible = false
            end
        else
            AimLine.Visible = false
        end
    else
        AimLine.Visible = false
    end
end)

-- HOOK castRay
local castRay
for _, fn in ipairs(getgc(true)) do
    if typeof(fn) == "function" then
        for _, uv in ipairs(debug.getupvalues(fn)) do
            if typeof(uv) == "function" and debug.getinfo(uv).name == "castRay" then
                castRay = uv
                break
            end
        end
    end
    if castRay then break end
end

if castRay then
    local old
    old = hookfunction(castRay, function(a, b, ...)
        local t = getTarget()
        if t then
            return t, t.Position
        end
        return old(a, b, ...)
    end)
end


-- ----
-- ‡∏ü‡∏±‡∏á‡∏ä‡∏±‡πà‡∏ô‡∏ö‡∏±‡∏û‡∏õ‡∏∑‡∏ô
-- -------

local function BuffGun(tool)
    if not buffEnabled then return end
    if tool:IsA("Tool") then
        task.wait(0.1)
        tool:SetAttribute("AutoFire", true)
        tool:SetAttribute("FireRate", 0.001)
        tool:SetAttribute("Damage", 999)
        tool:SetAttribute("IsReloading", false)
    end
end

local function ClearBuff(tool)
    if tool:IsA("Tool") then
        task.wait(0.1)
        tool:SetAttribute("AutoFire", false)
        tool:SetAttribute("FireRate", nil)
        tool:SetAttribute("Damage", nil)
        tool:SetAttribute("IsReloading", nil)
    end
end

local function HandleBuffOnTool(tool)
    if buffEnabled then
        BuffGun(tool)
    else
        ClearBuff(tool)
    end
end

local function ConnectCharacter(char)
    char.ChildAdded:Connect(HandleBuffOnTool)
end

local Players = game:GetService("Players")
local plr = Players.LocalPlayer

plr.CharacterAdded:Connect(function(char)
    ConnectCharacter(char)
end)

if plr.Character then
    ConnectCharacter(plr.Character)
end

for _, tool in pairs(plr.Backpack:GetChildren()) do
    HandleBuffOnTool(tool)
end

plr.Backpack.ChildAdded:Connect(HandleBuffOnTool)


-- ====
-- esp
-- ===
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer


local ESP_FOLDER = Instance.new("Folder")
ESP_FOLDER.Name = "ESP_FOLDER"
ESP_FOLDER.Parent = CoreGui

--// ‡∏™‡∏µ‡∏ó‡∏µ‡∏°
local function getTeamColor(player)
    if player.Team and player.TeamColor then
        return player.TeamColor.Color
    end
    return Color3.fromRGB(255,255,255)
end

--// ‡∏™‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏î
local function getHealthColor(hp, maxHp)
    local percent = hp / maxHp
    if percent > 0.6 then
        return Color3.fromRGB(0,255,0)
    elseif percent > 0.3 then
        return Color3.fromRGB(255,255,0)
    else
        return Color3.fromRGB(255,0,0)
    end
end

--// Create ESP
local function createESP(player)
    if player == LocalPlayer then return end

    local function onCharacter(char)
        local hum = char:WaitForChild("Humanoid",5)
        local root = char:WaitForChild("HumanoidRootPart",5)
        local head = char:WaitForChild("Head",5)
        if not hum or not root or not head then return end

        -- Highlight
        local hl = Instance.new("Highlight")
        hl.Adornee = char
        hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        hl.FillTransparency = 0.5
        hl.OutlineTransparency = 0
        hl.Enabled = false
        hl.Parent = ESP_FOLDER

        -- Name + HP
        local nameGui = Instance.new("BillboardGui")
        nameGui.Adornee = head
        nameGui.Size = UDim2.new(0,200,0,45)
        nameGui.StudsOffset = Vector3.new(0,2.5,0)
        nameGui.AlwaysOnTop = true
        nameGui.Parent = ESP_FOLDER

        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(1,0,0,20)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = player.Name
        nameLabel.TextSize = TEXT_SIZE
        nameLabel.Font = Enum.Font.SourceSansBold
        nameLabel.TextStrokeTransparency = 0
        nameLabel.Parent = nameGui

        local hpLabel = Instance.new("TextLabel")
        hpLabel.Position = UDim2.new(0,0,0,20)
        hpLabel.Size = UDim2.new(1,0,0,20)
        hpLabel.BackgroundTransparency = 1
        hpLabel.TextSize = TEXT_SIZE
        hpLabel.Font = Enum.Font.SourceSans
        hpLabel.TextStrokeTransparency = 0
        hpLabel.Parent = nameGui

        -- Distance
        local distGui = Instance.new("BillboardGui")
        distGui.Adornee = root
        distGui.Size = UDim2.new(0,200,0,20)
        distGui.StudsOffset = Vector3.new(0,-3,0)
        distGui.AlwaysOnTop = true
        distGui.Parent = ESP_FOLDER

        local distLabel = Instance.new("TextLabel")
        distLabel.Size = UDim2.new(1,0,1,0)
        distLabel.BackgroundTransparency = 1
        distLabel.TextSize = TEXT_SIZE
        distLabel.Font = Enum.Font.SourceSans
        distLabel.TextStrokeTransparency = 0
        distLabel.TextColor3 = Color3.new(1,1,1)
        distLabel.Parent = distGui

        -- Update
        RunService.RenderStepped:Connect(function()
            if not char.Parent or hum.Health <= 0 then
                nameGui:Destroy()
                distGui:Destroy()
                hl:Destroy()
                return
            end

            local teamColor = getTeamColor(player)
            local hp = math.floor(hum.Health)

            -- Name (‡∏™‡∏µ‡∏ó‡∏µ‡∏°)
            nameLabel.Visible = ESP_Name
            nameLabel.TextColor3 = teamColor

            -- HP (‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏î)
            hpLabel.Visible = ESP_Health
            hpLabel.Text = "HP: "..hp
            hpLabel.TextColor3 = getHealthColor(hp, hum.MaxHealth)

            -- Distance
            distGui.Enabled = ESP_Distance
            if ESP_Distance and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local dist = (LocalPlayer.Character.HumanoidRootPart.Position - root.Position).Magnitude
                distLabel.Text = math.floor(dist).." m"
            end

            -- Highlight (‡∏™‡∏µ‡∏ó‡∏µ‡∏°)
            hl.Enabled = ESP_Highlight
            hl.FillColor = teamColor
            hl.OutlineColor = teamColor
        end)
    end

    if player.Character then
        onCharacter(player.Character)
    end
    player.CharacterAdded:Connect(onCharacter)
end

--// Init
for _,plr in ipairs(Players:GetPlayers()) do
    createESP(plr)
end
Players.PlayerAdded:Connect(createESP)



-- ESPGUN 

local ESPSettings = {
    Enabled = false
}

local WEAPONS = {
    ["M9"] = "rbxassetid://121771988549115",
    ["Remington 870"] = "rbxassetid://80406360248544",
    ["MP5"] = "rbxassetid://95606011187656",
}

-- ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ
local BASE_SIZE = 18
local MIN_SIZE  = 10
local MAX_SIZE  = 18

local CACHE = {}
local ESPConnection = nil

local function getWeapons(player)
    local list = {}
    local added = {}

    -- Backpack
    local bp = player:FindFirstChild("Backpack")
    if bp then
        for _, t in ipairs(bp:GetChildren()) do
            if t:IsA("Tool") and WEAPONS[t.Name] and not added[t.Name] then
                added[t.Name] = true
                table.insert(list, t)
            end
        end
    end

    -- Holding
    if player.Character then
        for _, t in ipairs(player.Character:GetChildren()) do
            if t:IsA("Tool") and WEAPONS[t.Name] and not added[t.Name] then
                added[t.Name] = true
                table.insert(list, t)
            end
        end
    end

    return list
end

local function updatePlayer(player)
    if not ESPSettings.Enabled then return end
    if player == LocalPlayer then return end
    if not player.Character then return end

    local hrp = player.Character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    local cam = workspace.CurrentCamera
    if not cam or not cam.CFrame then return end

    -- clear old
    if CACHE[player] then
        CACHE[player]:Destroy()
        CACHE[player] = nil
    end

    local weapons = getWeapons(player)
    if #weapons == 0 then return end

    local dist = (cam.CFrame.Position - hrp.Position).Magnitude
    local size = math.clamp(BASE_SIZE * (35 / dist), MIN_SIZE, MAX_SIZE)

    local gui = Instance.new("BillboardGui")
    gui.Name = "ESPGUN"
    gui.Adornee = hrp
    gui.AlwaysOnTop = true
    gui.StudsOffset = Vector3.new(0, -5.5, 0)
    gui.Size = UDim2.new(0, (#weapons * (size + 6)) + 6, 0, size + 6)
    gui.Parent = player.Character

    local layout = Instance.new("UIListLayout")
    layout.Parent = gui
    layout.FillDirection = Enum.FillDirection.Horizontal
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    layout.Padding = UDim.new(0, 6)

    for _, tool in ipairs(weapons) do
        local img = Instance.new("ImageLabel")
        img.Parent = gui
        img.Size = UDim2.new(0, size, 0, size)
        img.Image = WEAPONS[tool.Name]
        img.BackgroundColor3 = Color3.fromRGB(240,240,240)
        img.BackgroundTransparency = 0.1

        Instance.new("UICorner", img).CornerRadius = UDim.new(0, 7)

        local stroke = Instance.new("UIStroke", img)
        stroke.Thickness = 2
        stroke.Transparency = 1

        
        if tool.Parent == player.Character then
            stroke.Transparency = 0
            stroke.Color = Color3.fromRGB(0,170,255)
        end
    end

    CACHE[player] = gui
end

local function enableESP()
    if ESPConnection then return end

    ESPConnection = RunService.Heartbeat:Connect(function()
        for _, p in ipairs(Players:GetPlayers()) do
            updatePlayer(p)
        end
    end)
end

local function disableESP()
    if ESPConnection then
        ESPConnection:Disconnect()
        ESPConnection = nil
    end

    for _, gui in pairs(CACHE) do
        if gui then gui:Destroy() end
    end
    CACHE = {}
end


Players.PlayerRemoving:Connect(function(p)
    if CACHE[p] then
        CACHE[p]:Destroy()
        CACHE[p] = nil
    end
end)



-- 
-- walkspeed


local function UpdateBody()
    local char = LocalPlayer.Character
    if not char then return end

    local hum = char:FindFirstChildOfClass("Humanoid")
    if not hum then return end

    -- WalkSpeed
    hum.WalkSpeed = Body.WalkSpeed.Enabled
        and Body.WalkSpeed.Value
        or Body.WalkSpeed.Default
end

--// ‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(0.2)
    UpdateBody()
end)

--// ‡∏Å‡∏±‡∏ô‡πÄ‡∏Å‡∏°‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏•‡∏±‡∏ö
RunService.Heartbeat:Connect(function()
    if Body.WalkSpeed.Enabled then
        UpdateBody()
    end
end)



local Tab = Window:Tab({Title = "MAIN", Icon = "list"})

Tab:Toggle({
    Title = "Silent Aim",
    Desc = "‡∏•‡πá‡∏≠‡∏Ñ‡∏Å‡∏£‡∏∞‡∏™‡∏∏‡∏ô",
    Icon = "target",
    Type = "Checkbox",
    Value = getgenv().SilentAimbot,
    Callback = function(state)
        getgenv().SilentAimbot = state
        FOVCircle.Visible = state
        AimLine.Visible = state
    end
})


Tab:Slider({
    Title = "FOV Size",
    Desc = "‡∏õ‡∏£‡∏±‡∏ö‡∏ß‡∏á",
    Step = 1,
    Value = {
        Min = 50,
        Max = 500,
        Default = getgenv().SAIM_FOV,
    },
    Callback = function(value)
        getgenv().SAIM_FOV = value
    end
})


Tab:Dropdown({
    Title = "Search Teame lock",
    Desc = "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏´‡πâSilent aim‡∏°‡∏±‡∏ô‡∏•‡πá‡∏≠‡∏Ñ",
    Values = { "Neutral", "Guards", "Inmates", "Criminals" },
    Value = { "Neutral" },
    Multi = true,
    AllowNone = false,
    Callback = function(selectedTeams)
        updateTeamsFromDropdown(selectedTeams)
    end
})


Tab:Toggle({
    Title = "Buff ‡∏õ‡∏∑‡∏ô",
    Desc = "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏∑‡∏ô‡∏¢‡∏¥‡∏á‡∏£‡∏±‡∏ß",
    Value = false,
    Callback = function(v)
        buffEnabled = v
        
        for _, tool in pairs(plr.Backpack:GetChildren()) do
            HandleBuffOnTool(tool)
        end
        
        if plr.Character then
            for _, tool in pairs(plr.Character:GetChildren()) do
                HandleBuffOnTool(tool)
            end
        end
    end
})

local EspTab = Window:Tab({Title = "ESP", Icon = "eye"})

EspTab:Toggle({
    Title = "ESP Name",
    Value = false,
    Callback = function(v)
        ESP_Name = v
    end
})

EspTab:Toggle({
    Title = "ESP Health",
    Value = false,
    Callback = function(v)
        ESP_Health = v
    end
})

EspTab:Toggle({
    Title = "ESP Distance",
    Value = false,
    Callback = function(v)
        ESP_Distance = v
    end
})

EspTab:Toggle({
    Title = "ESP Highlight",
    Value = false,
    Callback = function(v)
        ESP_Highlight = v
    end
})

EspTab:Toggle({
    Title = "ESP GUN Player",
    Desc = "‡∏°‡∏≠‡∏á‡∏õ‡∏∑‡∏ô‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏∞",
    Default = false,
    Callback = function(state)
        ESPSettings.Enabled = state

        if state then
            enableESP()
        else
            disableESP()
        end
    end
})



local bodyTab = Window:Tab({Title = "Body", Icon = "dna"})

bodyTab:Toggle({
    Title = "Walk Speed",
    Desc = "‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß",
    Default = false,
    Callback = function(state)
        Body.WalkSpeed.Enabled = state
        UpdateBody()
    end
})


bodyTab:Slider({
    Title = "Speed Value",
    Desc = "‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πà‡∏á",
    Step = 1,
    Value = {
        Min = 16,
        Max = 120,
        Default = 16
    },
    Callback = function(value)
        Body.WalkSpeed.Value = value
        UpdateBody()
    end
})
